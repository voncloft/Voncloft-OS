# description : "Self-service finite-state machines for the programmer on the go."

pkgbase=python-automat
version=20.2.0
release=5
url="https://github.com/glyph/automat"
source="$pkgbase-$version.tar.gz::https://github.com/glyph/automat/archive/v$version.tar.gz"
sha512sums=ccba3e82f589fedb1f83dfb37a6a42b51a78d8c3e6fea22c9518135ff194f5f70e2f9c5f0eab50b6e116dae92c94754aac8dbf0e670a59015c916991736b4076

prepare {
  cp -a automat-$version{,-py2}

  # Set version for setuptools_scm
  export SETUPTOOLS_SCM_PRETEND_VERSION=$version
}

build()-delete {
   cd "$srcdir"/automat-$version
  python setup.py build

   cd "$srcdir"/automat-$version-py2
}

check {
   cd "$srcdir"/automat-$version
  python -m pytest --deselect benchmark

   cd "$srcdir"/automat-$version-py2
}

package_python-automat {
  # depends : python-attrs

   cd automat-$version
  python setup.py build
  python setup.py install --root=$PKG --optimize=1
}


   cd automat-$version-py2

  mv $PKG/usr/bin/automat-visualize{,2}
}
