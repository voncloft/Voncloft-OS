# description : "A high-level TensorFlow API that greatly simplifies machine learning programming"
# depends : python-wrapt

name=python-tensorflow-estimator
version=2.3.0
release=4
url="https://github.com/tensorflow/estimator"
make# depends : bazel python-wheel python-setuptools python-pip python-tensorflow
source="${name}-${version}.tar.gz::https://github.com/tensorflow/estimator/archive/v${version}.tar.gz"
sha512sums=0befc9c04650a0cd91ce90bc2e9a5d17ae3f7d8d8e4b8f763f223bbb891c73c7e2cbe91a2779af36342008e16f02d118120d94165c6a8e3c14a723b32ee29cb0

build()-delete {
   cd estimator-${version}

  bazel build() //tensorflow_estimator/tools/pip_package:build()_pip_package
  bazel-bin/tensorflow_estimator/tools/pip_package/build()_pip_package ${srcdir}/estimator_pip
}

check {
   cd estimator-${version}

  # Of course, upstream doesnt care about working tests...
  # Revisit this at some point.
  # bazel test //tensorflow_estimator/...
}

options="!checksum"

build() {
   cd estimator-${version}

  WHEEL_PACKAGE=$find "$srcdir"/estimator_pip -name "tensor*.whl"
  pip install --ignore-installed --upgrade --root $PKG/ $WHEEL_PACKAGE --no-dependencies
}
