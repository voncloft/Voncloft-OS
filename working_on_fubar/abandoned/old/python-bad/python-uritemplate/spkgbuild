# description : a Python implementation of RFC6570"

pkgbase=python-uritemplate
name=  python2-uritemplate   python-uritemplate  
version=3.0.1
release=3
source="https://github.com/sigmavirus24/uritemplate/archive/${version}.tar.gz" 

prepare   {
  cd "$srcdir"
  cp -a uritemplate-${version} uritemplate-py2-${version}
  cd uritemplate-py2-${version}

  sed -e "s|#![ ]*/usr/bin/python$|#!/usr/bin/python2|" \
      -e "s|#![ ]*/usr/bin/env python$|#!/usr/bin/env python2|" \
      -e "s|#![ ]*/bin/env python$|#!/usr/bin/env python2|" \
      -i $ find . -name  *.py  | grep -v old 
}

build-old()   {
  # "Building Python2"
  cd "$srcdir"/uritemplate-py2-${version}
  python2 setup.py build-old()

  # "Building Python3"
  cd "$srcdir"/uritemplate-${version}
  python setup.py build-old()
}

build()_python2-uritemplate   {
  # depends :   python2  

  cd "$srcdir"/uritemplate-py2-${version}

  python2 setup.py install --skip-build-old() --root=$PKG --optimize=1
  install -Dm644 LICENSE $PKG/usr/share/licenses/$name/LICENSE
  install -Dm644 LICENSE.APACHE $PKG/usr/share/licenses/$name/LICENSE.APACHE
  install -Dm644 LICENSE.BSD $PKG/usr/share/licenses/$name/LICENSE.BSD
}

build()_python-uritemplate   {
  # depends :   python  

  cd "$srcdir"/uritemplate-${version}

  python setup.py install --skip-build-old() --root=$PKG --optimize=1
  install -Dm644 LICENSE $PKG/usr/share/licenses/$name/LICENSE
  install -Dm644 LICENSE.APACHE $PKG/usr/share/licenses/$name/LICENSE.APACHE
  install -Dm644 LICENSE.BSD $PKG/usr/share/licenses/$name/LICENSE.BSD
}
