# description : transfer files to server outside of network
# depends : libnsl

name=vsftpd
version=3.0.3
release=1

source="https://security.appspot.com/downloads/$name-$version.tar.gz"
options="!checksum"

build() {
	cd $name-$version
	install -v -d -m 0755 $PKG/usr/share/vsftpd/empty
	install -v -d -m 0755 $PKG/home/ftp
	groupadd -g 47 vsftpd 
	groupadd -g 45 ftp 
	useradd -c "vsftpd User"  -d /dev/null -g vsftpd -s /bin/false -u 47 vsftpd
	useradd -c anonymous_user -d /home/ftp -g ftp    -s /bin/false -u 45 ftp

	sed -e "s/kVSFSysStrOpenUnknown;/(enum EVSFSysUtilOpenMode)&/" -i sysstr.c
	make
	install -v -m 755 vsftpd        $PKG/usr/sbin/vsftpd 
	install -v -m 644 vsftpd.conf   $PKG/etc
	cat <<-EOF > $PKG/etc/vsftpd.conf
	background=YES
	listen=YES
	nopriv_user=vsftpd
	secure_chroot_dir=/usr/share/vsftpd/empty
	seccomp_sandbox=NO
	local_enable=YES
	EOF

	
	
}
