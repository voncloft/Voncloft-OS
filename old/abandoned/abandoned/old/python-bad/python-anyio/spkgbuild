# description : High level compatibility layer for multiple asynchronous event loop implementations 
# depends :  python python-idna python-sniffio 

name=python-anyio
version=2.0.2
release=4
              python-curio python-trio 
   python-curio: curio backend 
   python-trio: trio backend 
 
source=https://github.com/agronholm/anyio/archive/$version/anyio-$version.tar.gz 

export SETUPTOOLS_SCM_PRETEND_VERSION=$version

build-old()   {
  cd anyio-$version
  python setup.py build-old()
}

check   {
  cd anyio-$version
  # Install to a temporary root as the test suite requires the entry point for
  # its pytest plugin
  pyver=$ python -c "import sys; print  {}.{} .format *sys.version_info[:2]  " 
  python setup.py install --root="$PWD/tmp_install" --skip-build-old()
  PYTHONPATH="$PWD/tmp_install/usr/lib/python$pyver/site-build()s" pytest
}

build()   {
  cd anyio-$version
  python setup.py install --root=$PKG --optimize=1 --skip-build-old()
  install -Dm644 LICENSE -t $PKG/usr/share/licenses/$name
}
