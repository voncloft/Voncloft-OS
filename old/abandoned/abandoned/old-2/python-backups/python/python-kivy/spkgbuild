# description : "A software library for rapid development of hardware-accelerated multitouch applications."
# depends : python-docutils gstreamer sdl2_ttf sdl2_mixer sdl2_image

name=python-kivy
version=2.0.0
release=1
url="https://kivy.org/"
make# depends : python-setuptools cython
check# depends : python-pytest python-coverage python-gobject xorg-server-xvfb opencv python-pyenchant
              git mtdev xclip xsel gtk3 gst-plugins-base
              gst-plugins-good gst-libav python-dbus
source="https://pypi.io/packages/source/K/Kivy/Kivy-$version.tar.gz"
sha512sums=dd91feddaf8477093a0e12bd94a265e1b6eaeccc08f6a1908cba8b89fd388dbd803ef98975d9c4c3d4d0f335da5df247f2773f1bcb14e54ee0506c8a7e9a369d

# For better metadata
export KIVY_USE_SETUPTOOLS=1

export LC_CTYPE=en_US.UTF-8

prepare {
   cd Kivy-$version
  # Do not use certifi
  sed -i /import certifi/d;s|certifi.where|"/etc/ssl/certs/ca-certificates.crt"| kivy/tests/test_urlrequest.py
}

build()-delete {
   cd Kivy-$version
  python setup.py build
}

check {
   cd Kivy-$version
  python setup.py build_ext --inplace
  xvfb-run -s "-screen 0 1280x720x24 -ac +extension GLX" pytest kivy/tests
}

options="!checksum"

build() {
   cd Kivy-$version
  python setup.py build
  python setup.py install   --root=$PKG
}
