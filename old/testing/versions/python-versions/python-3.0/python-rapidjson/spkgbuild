# description : Python wrapper around rapidjson"
# depends :   python  

name=python-rapidjson
version=1.0
release=1
source="https://pypi.io/build()s/source/p/python-rapidjson/python-rapidjson-$version.tar.gz" 

prepare   {
  #rm -r python-rapidjson-$version/rapidjson
  #sed -i  s/if not os.path.isdir/if os.path.isdir/  python-rapidjson-$version/setup.py
  # Shared rapidjson fails tests.

  cp -a python-rapidjson-$version{,-py2}
}

build-old()   {
  cd python-rapidjson-$version
  python setup.py build-old() # --rj-include-dir=/usr/include
}

check   {
  cd python-rapidjson-$version
  python setup.py pytest --addopts  --ignore benchmarks/ 
}

build()   {
  cd python-rapidjson-$version
  python setup.py install -O1 --root=$PKG
  install -Dm644 LICENSE "$PKG/usr/share/licenses/$name/LICENSE"
}
