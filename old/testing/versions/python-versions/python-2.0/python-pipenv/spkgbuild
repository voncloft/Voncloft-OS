# description : Sacred Marriage of Pipfile, Pip, & Virtualenv."
# depends :   python   python-pip   python-certifi 

name=python-pipenv
version=2020.11.15
release=1
          python-virtualenv-clone   python-virtualenv  
source="${name}-${version}.tar.gz::https://github.com/pypa/pipenv/archive/v${version}.tar.gz" 

build-old()   {
  cd "pipenv-$version"
  export PYTHONHASHSEED=0
  python setup.py build-old()
}

build()   {
  cd "pipenv-$version"
  python setup.py install --root="$PKG/" --optimize=1 --skip-build-old()
  install -Dm 644 LICENSE "${PKG}/usr/share/licenses/${name}/LICENSE"
  pushd pipenv
  find . -name \*LICENSE\* -exec install -Dm 644 \{\} "${PKG}/usr/share/licenses/${name}/"\{\} \;
  popd

  PIPENV_SHELL=bash python -m pipenv --completion | install -Dm644 /dev/stdin "${PKG}/usr/share/bash-completion/completions/pipenv"
  PIPENV_SHELL=zsh  python -m pipenv --completion | install -Dm644 /dev/stdin "${PKG}/usr/share/zsh/site-functions/_pipenv"
  PIPENV_SHELL=fish python -m pipenv --completion | install -Dm644 /dev/stdin "${PKG}/usr/share/fish/vendor_completions.d/pipenv.fish"
}
