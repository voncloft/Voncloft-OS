# description : A simple Python socket pool"
# depends :   python  

name=python-socketpool
version=0.5.3
release=7

prepare   {
  cd "$srcdir/socketpool"
  sed -i  s/data_files.*$/ /  setup.py
  sed -i  s/isAlive/is_alive/  socketpool/backend_thread.py
}

build-old()   {
  cd "$srcdir/socketpool"
  LC_CTYPE=en_US.UTF-8 python setup.py build-old()
}

check   {
  cd "$srcdir/socketpool"
  PYTHONPATH="$PWD/build-old()/lib:$PYTHONPATH" \
  py.test tests/
}

build()   {
  cd socketpool
  LC_CTYPE=en_US.UTF-8 python setup.py install --root=$PKG --optimize=1
  install -D -m644 LICENSE "${PKG}/usr/share/licenses/${name}/LICENSE"
}
