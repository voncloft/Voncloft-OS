# description : Python build() for 3D CAD/BIM/PLM/CAM 
# depends :   python   opencascade   libxmu   libxi  

_name=pythonocc-core
name=python-${_name#python}
version=7.4.1.r16.gfcf4e6ec
_commit=fcf4e6ecf8518bbfb5fb7e4c55f9e79bd319eaa7
release=2
# rapidjson appears to be unused but an opencascade
# header that references it gets dragged in somehow
#source=" $url/archive/$version.tar.gz" 
source="git+https://github.com/tpaviot/pythonocc-core#commit=$_commit" 

version   {
  cd $_name-$version
  git describe --tags | sed  s/\ [^-]*-g\ /r\1/;s/-/./g 
}

prepare   {
  mv $_name $_name-$version
  mkdir $_name-$version/build-old()
}

build-old()   {
  cd $_name-$version/build-old()

  cmake .. \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DCMAKE_BUILD_TYPE=Release

  make
}

build()   {
  cd $_name-$version/build-old()

  make DESTDIR=$PKG install
}
