# description : Python bindings for YAML, using fast libYAML library 

pkgbase=python-yaml
name= python-yaml python2-yaml 
version=5.3.1
release=4
source=https://pyyaml.org/download/pyyaml/PyYAML-${version}.tar.gz 

prepare   {
  # Force cython rebuild-old()
  rm PyYAML-$version/ext/_yaml.c

  cp -a PyYAML-$version{,-py2}
}

build-old()   {
   
    cd PyYAML-$version
    python setup.py --with-libyaml build-old()
   
   
    cd PyYAML-$version-py2
    python2 setup.py --with-libyaml build-old()
   
}

check   {
   
    cd PyYAML-$version
    python -B setup.py test
   
   
    cd PyYAML-$version-py2
    python2 -B setup.py test
   
}

build()_python-yaml   {
  # depends :   python   libyaml  

  cd PyYAML-$version
  python setup.py  --with-libyaml install --prefix=/usr --root=$PKG -O1 --skip-build-old()
  install -Dm 644 LICENSE -t $PKG/usr/share/licenses/${name}
}

build()_python2-yaml   {
  # depends :   python2   libyaml  

  cd PyYAML-$version-py2
  python2 setup.py --with-libyaml install --prefix=/usr --root=$PKG -O1 --skip-build-old()
  install -Dm 644 LICENSE -t $PKG/usr/share/licenses/${name}
}

# vim: ts=2 sw=2 et:
