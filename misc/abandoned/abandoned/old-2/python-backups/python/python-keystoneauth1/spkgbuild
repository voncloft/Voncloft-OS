# description : "Authentication Library for OpenStack Identity"
# depends : python-pbr python-iso8601 python-stevedore python-os-service-types python-requests

name=python-keystoneauth1
version=4.3.0
release=1
url="https://docs.openstack.org/developer/keystoneauth"
opt# depends : python-requests-kerberos: for kerberos support
            python-lxml: for saml2 support
            python-oauthlib: for oauth1 support
            python-betamax: for betamax support
            python-fixtures: for betamax support
            python-mock: for betamax support
check# depends : python-requests-mock python-testscenarios python-mock python-lxml
              python-oslo-config python-betamax python-oslotest python-oslo-utils
              python-requests-kerberos python-oauthlib python-pycodestyle python-hacking
source="$name-$version.tar.gz::https://github.com/openstack/keystoneauth/archive/$version.tar.gz"
sha512sums=ba1efac2a0e2c95ac0ab2c07d01b05a72a3388a9e8ec2ba5389fae260ac0acd86961aa290b804f9e16dec3c8a0c1b98d0811d692bb5ee7c9a22216e710dc62ac

export PBR_VERSION=$version

prepare {
  sed -i s/pep8/pycodestyle/g keystoneauth-$version/keystoneauth1/tests/unit/test_hacking_checks.py
  sed -i s/assertItemsEqual/assertCountEqual/ keystoneauth-$version/keystoneauth1/tests/unit/extras/kerberos/*.py
}

build()-delete {
   cd keystoneauth-$version
  python setup.py build
}

check {
   cd keystoneauth-$version
  stestr run
}

options="!checksum"

build() {
   cd keystoneauth-$version
  python setup.py build
  python setup.py install --root="$PKG/" --optimize=1
}

