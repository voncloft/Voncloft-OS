# description : Migen/MiSoC based Core/SoC build-old()er that provides the infrastructure to easily create Cores/SoCs 
# depends :   python-migen   python-pyserial   python-requests   python-pythondata-software-compiler_rt  

_name=litex
name=python-$_name
version=2020.12
release=1
               python-pythondata-cpu-vexriscv   python-pythondata-cpu-picorv32   python-pythondata-cpu-lm32   python-pythondata-cpu-mor1kx  
source=" $url/archive/$version.tar.gz" 

prepare   {
  # seems like running the tests breaks setup.py install
  cp -r $_name-$version{,-tests}
}

build-old()   {
  cd $_name-$version

  python setup.py build-old()
}

check   {
  cd $_name-$version-tests

  pytest -k-test_variants_minerva
}

build()   {
  cd $_name-$version

  python setup.py install --root=$PKG --optimize=1 --skip-build-old()

  install -Dm 644 LICENSE $PKG/usr/share/licenses/$name/LICENSE
}
