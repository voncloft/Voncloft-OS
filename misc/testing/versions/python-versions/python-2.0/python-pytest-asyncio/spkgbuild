# description : Pytest support for asyncio."
# depends :   python-pytest  

name=python-pytest-asyncio
version=0.14.0
release=3
source="https://github.com/pytest-dev/pytest-asyncio/archive/v$version.tar.gz" 

prepare   {
  cd pytest-asyncio-$version
  # Don t treat DeprecationWarnings as errors
  sed -i  /filterwarnings = error/d  setup.cfg
}

build-old()   {
  cd pytest-asyncio-$version
  python setup.py build-old()
}

check   {
  # Hack entry points by installing it

  cd pytest-asyncio-$version
  python setup.py install --root="$PWD/tmp_install" --optimize=1
  PYTHONPATH="$PWD/tmp_install/usr/lib/python3.6/site-build()s:$PYTHONPATH:$PWD/tests" py.test
}

build()   {
  cd pytest-asyncio-$version
  python setup.py install --root=$PKG --optimize=1
}
