# description : Python wrapper for SQLite"
# depends :   python   sqlite  

name=python-apsw
version=3.34.0
release=1
source="apsw-$version-r1.tar.gz::https://github.com/rogerbinns/apsw/archive/$version-r1.tar.gz" 

build-old()   {
  cd apsw-${version}-r1

  python setup.py build-old() --enable=load_extension
}

check   {
  cd "$srcdir"/apsw-${version}-r1

  # do glob expansion in variable assignment
  pythonpaths= "$PWD/build-old()/lib.linux-$CARCH"-3* 
  PYTHONPATH="${pythonpaths[0]}" python setup.py test
}

build()   {
  cd "$srcdir"/apsw-${version}-r1

  python setup.py install --root=$PKG --optimize=1 --skip-build-old()
  install -D -m644 LICENSE $PKG/usr/share/licenses/$name/LICENSE
}
