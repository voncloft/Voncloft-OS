
pkgbase=python-psutil
name=  python-psutil   python2-psutil  
version=5.8.0
release=1
source="https://github.com/giampaolo/psutil/archive/release-$version.tar.gz" 

build   {
  cd psutil-release-$version

  python setup.py build --build-lib=build/python

  python2 setup.py build --build-lib=build/python2
  find build/python2 -type f -exec \
    sed -i  1s,^#! \?/usr/bin/\ env \|\ python$,#!/usr/bin/python2,  {} \;
}

check   {
  cd psutil-release-$version

  # Required for testing
#cp setup.py build/python
#cp -r scripts build/python/

# 4 non-working tests in build chroot, requires fixes. Test framework does not allow exclusion.
#  PYTHONPATH="$PWD/build/python" python psutil/tests/__main__.py
}

package_python-psutil   {
  # description : A cross-platform process and system utilities module for Python 
  # depends :   python  

  cd psutil-release-$version
  python setup.py build --build-lib=build/python \
                  install --root=$PKG --optimize=1
  install -D -m 644 LICENSE "$PKG/"usr/share/licenses/$name/LICENSE
}

package_python2-psutil   {
  # description : A cross-platform process and system utilities module for Python2 
  # depends :   python2  

  cd psutil-release-$version
  python2 setup.py build --build-lib=build/python2 \
                   install --root=$PKG --optimize=1
  install -D -m 644 LICENSE "$PKG/"usr/share/licenses/$name/LICENSE
}

# vim:set ts=2 sw=2 et:
