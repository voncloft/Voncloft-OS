
_name=binaryornot
name=python-binaryornot
version=0.4.4
release=4
# description : Ultra-lightweight pure Python package to check if a file is binary or text"
# depends :   python-chardet  
source="https://files.pythonhosted.org/packages/source/${_name::1}/${_name}/${_name}-${version}.tar.gz"
        "${name}-0.4.4-hypothesis_tests.patch::https://github.com/audreyr/binaryornot/pull/52.patch" 
             8a0f1066a580f08778434ed7d30c2ebf2764dbfd746b561ffce2fb8dd8d77cafaf4a58b03504cf5b1e4d37e0a6ffe3038dcaa5611cdfd7d42ada86edd1e47f3f  

prepare   {
  mv -v "${_name}-${version}" "$name-$version"
  cd "$name-$version"
  # fix tests using python-hypothesis:
  #https://github.com/audreyr/binaryornot/issues/46
  patch -Np1 -i "../${name}-0.4.4-hypothesis_tests.patch"
}

build   {
  cd "$name-$version"
  python setup.py build
}

check   {
  cd "$name-$version"
# tests can only be run via setuptools:
#https://github.com/audreyr/binaryornot/issues/160
#  export PYTHONPATH="build:${PYTHONPATH}"
#  pytest -v
  python setup.py test
}

package   {
  cd "$name-$version"
  python setup.py install --skip-build \
    --optimize=1 \
    --prefix=/usr \
    --root=$PKG
  install -vDm 644 LICENSE -t "${PKG}/usr/share/licenses/${name}"
    -t "${PKG}/usr/share/doc/${name}"
}
