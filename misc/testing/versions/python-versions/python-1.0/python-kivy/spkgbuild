
name=python-kivy
version=2.0.0
release=1
# description : A software library for rapid development of hardware-accelerated multitouch applications."
# depends :   python-docutils   gstreamer   sdl2_ttf   sdl2_mixer   sdl2_image  
               git   mtdev   xclip   xsel   gtk3   gst-plugins-base 
               gst-plugins-good   gst-libav   python-dbus  
source="https://pypi.io/packages/source/K/Kivy/Kivy-$version.tar.gz" 

# For better metadata
export KIVY_USE_SETUPTOOLS=1

export LC_CTYPE=en_US.UTF-8

prepare   {
  cd Kivy-$version
  # Do not use certifi
  sed -i  /import certifi/d;s|certifi.where  |"/etc/ssl/certs/ca-certificates.crt"|  kivy/tests/test_urlrequest.py
}

build   {
  cd Kivy-$version
  python setup.py build
}

check   {
  cd Kivy-$version
  python setup.py build_ext --inplace
  xvfb-run -s "-screen 0 1280x720x24 -ac +extension GLX" pytest kivy/tests
}

package   {
  cd Kivy-$version
  python setup.py install --prefix=/usr --root=$PKG
  install -Dm644 LICENSE $PKG/usr/share/licenses/$name/LICENSE
}
