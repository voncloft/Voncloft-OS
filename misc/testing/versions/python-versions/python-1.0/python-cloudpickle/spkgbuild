
_pkg=cloudpickle
name=python-${_pkg}
version=1.6.0
release=1
# description : Extended pickling support for Python objects"
# depends :  python-setuptools 
    python-pytest
    python-psutil
    python-tornado
    python-numpy
 
options= !emptydirs 
source=https://files.pythonhosted.org/packages/source/${_pkg::1}/${_pkg}/${_pkg}-${version}.tar.gz 

build   {
  cd ${_pkg}-${version}
  python setup.py build
}

check   {
  cd ${_pkg}-${version}
  cd tests/cloudpickle_testpkg
  python setup.py build
  cd ../../
  PYTHONPATH="${PWD}"/tests/cloudpickle_testpkg/build/lib/ \
  pytest --deselect tests/cloudpickle_file_test.py::CloudPickleFileTests::test_pickling_special_file_handles \
         --deselect tests/cloudpickle_test.py::CloudPickleTest::test_pickling_file_handles \
         --deselect tests/cloudpickle_test.py::Protocol2CloudPickleTest::test_pickling_file_handles
}

package   {
  cd ${_pkg}-${version}
  python setup.py install --prefix=/usr --root=$PKG --optimize=1 --skip-build
  install -Dm644 LICENSE -t $PKG/usr/share/licenses/${name}/
}
