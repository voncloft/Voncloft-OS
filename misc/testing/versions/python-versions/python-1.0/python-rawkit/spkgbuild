
_name=rawkit
name=python-rawkit
version=0.6.0
release=9
# description : ctypes based libraw bindings "
# depends :   libraw   python  
source= ${_name}-${version}.tar.gz::https://github.com/photoshell/rawkit/archive/v${version}.tar.gz
       https://github.com/photoshell/rawkit/pull/140/commits/663e90afa835d398aedd782c87b8cd0bff64bc9f.patch
        libraw19-support.patch 
             1297740c3825d41b394808b3be145d0f41effc415e5dbd6fd1e17e51328ce418 
             104598076673c435f863cd25508060c0f2639b46d0fdcce7fa89b7723af443c5  

prepare   {
  cd "${srcdir}"/${_name}-${version}

  # python 3.7
  patch -p1 -i "${srcdir}"/663e90afa835d398aedd782c87b8cd0bff64bc9f.patch
  # FS#60708 fix
  patch -p1 -i "${srcdir}"/libraw19-support.patch
}

build   {
  cd "${srcdir}"/${_name}-${version}

  python setup.py build
}

check   {
  cd "${srcdir}"/${_name}-${version}

  python -m pytest
}

package_python-rawkit   {
  cd "${srcdir}"/${_name}-${version}
  python setup.py install --root=$PKG --optimize=1 --skip-build
  install -Dm644 LICENSE $PKG/usr/share/licenses/${name}/LICENSE
}
