
name=python-eventlet
_pyname=eventlet
version=0.30.0
release=1
# description : Highly concurrent networking library 
# depends :   python   python-greenlet   python-monotonic   python-dnspython  
   python-psycopg2: non-blocking PostgreSQL support 
   python-pyopenssl: non-blocking SSL support 
   python-httplib2: non-blocking HTTP support 
   python-pyzmq: non-blocking ZeroMQ support 
   python-dnspython: non-blocking DNS support 
 
options=  !makeflags  
source=https://github.com/eventlet/eventlet/archive/v${version}/${_pyname}-${version}.tar.gz 

prepare   {
  cd ${_pyname}-${version}
  sed -r  s| check_idle_cpu_usage\ .*,  .*\ |\1 0.8\ |g  -i tests/*_test.py
}

build   {
  cd ${_pyname}-${version}
  python setup.py build
  make -C doc text
}

check   {
  cd ${_pyname}-${version}
  nosetests -sv tests
}

package   {
  cd ${_pyname}-${version}
  python setup.py install --prefix=/usr --root=$PKG -O1
  install -Dm 644 LICENSE -t "${PKG}/usr/share/licenses/${name}"
  install -d "${PKG}/usr/share/doc/${name}"
  cp -r doc/_build/text "${PKG}/usr/share/doc/${name}"
  cp -r examples "${PKG}/usr/share/doc/${name}"
}

# vim: ts=2 sw=2 et:
