
pkgbase=python-pep517
name=('python-pep517' 'python2-pep517')
version=0.9.1
release=3
# description : "Wrappers to build Python packages using PEP 517 hooks"
             'python2-importlib-metadata' 'python2-zipp')
source=("https://pypi.io/packages/source/p/pep517/pep517-$version.tar.gz")

prepare() {
  cp -a pep517-$version{,-py2}
}

build-remove() {
  cd "$srcdir"/pep517-$version
  python setup.py build

  cd "$srcdir"/pep517-$version-py2
  python2 setup.py build
}

check() {
  cd pep517-$version
  # https://github.com/pypa/pep517/issues/35
  pytest --deselect setup.py
}

package_python-pep517() {
  # depends : ('python-toml')

  cd pep517-$version
  python setup.py install --root=$PKG --optimize=1 --skip-build
}

package_python2-pep517() {
  # depends : ('python2-toml' 'python2-importlib-metadata' 'python2-zipp')

  cd pep517-$version-py2
  python2 setup.py install --root=$PKG --optimize=1 --skip-build
}
