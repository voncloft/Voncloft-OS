# description : Faster and more correct implementation of the Package::Stash API
# depends : perl

name=perl-package-stash-xs
version=0.29
release=4
url=https://search.cpan.org/dist/Package-Stash-XS
make# depends : perl-extutils-makemaker
check# depends : perl-test-fatal perl-test-requires
source="https://search.cpan.org/CPAN/authors/id/E/ET/ETHER/Package-Stash-XS-$version.tarsource=.gz"
options=!checksum
md5sums=e5b58846a01aa39c36605e071c306dcc

build-delete {
   export PERL_MM_USE_DEFAULT=1 PERL5LIB=                 \
      PERL_AUTOINSTALL=--skipdeps                            \
      PERL_MM_OPT=INSTALLDIRS=vendor     \
      PERL_MB_OPT=--installdirs vendor \
      MODULEBUILDRC=/dev/null

    cd Package-Stash-XS-${version}

    /usr/bin/perl Makefile.PL

    make
  
}

check {
   export PERL_MM_USE_DEFAULT=1 PERL5LIB=
    cd Package-Stash-XS-${version}

    make test
  
}

build() {
    cd Package-Stash-XS-${version}

    make DESTDIR=$PKG/ install
}
