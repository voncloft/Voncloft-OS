# description : Test::Without::Module - Test fallback behaviour in absence of modules
# depends : perl

name=perl-test-without-module
version=0.20
release=6

url=https://search.cpan.org/dist/Test-Without-Module/

make# depends : perl
check# depends : perl-file-slurp

source="https://search.cpan.org/CPAN/authors/id/C/CO/CORION/Test-Without-Module-$version.tarsource=.gz"
options=!checksum

sha256sums=8e9aeb7c32a6c6d0b8a93114db2a8c072721273a9d9a2dd4f9ca86cfd28aa524


build-delete {
	cd Test-Without-Module-$version

	# Setting these env variables overwrites any command-line-options we dont want...
	export PERL_MM_USE_DEFAULT=1 PERL_AUTOINSTALL=--skipdeps \
	       PERL_MM_OPT= PERL_MB_OPT= MODULEBUILDRC=/dev/null

	perl Makefile.PL INSTALLDIRS=vendor
	make
}

check {
	cd Test-Without-Module-$version
	make test
}

build() {
	cd Test-Without-Module-$version
	make install DESTDIR=$PKG
	find $PKG -name .packlist -o -name perllocal.pod -delete
}
