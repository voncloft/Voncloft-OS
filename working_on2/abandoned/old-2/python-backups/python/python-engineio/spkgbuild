# description : Python implementation of the Engine.IO realtime server
# depends : python python-six python-urllib3 python-websocket-client python-websockets

name=python-engineio
version=4.0.0
release=1
url=https://github.com/miguelgrinberg/python-engineio
opt# depends : python-eventlet: eventlet driver
            python-aiohttp: aiohttp driver
            python-tornado: tornado driver
            python-gevent: gevent driver
            python-gevent-websocket: gevent driver
make# depends : python-setuptools python-sphinx python-six python-eventlet python-aiohttp python-tornado
             python-urllib3 python-websocket-client python-gevent python-gevent-websocket python-websockets
check# depends : python-mock python-pytest python-pytest-runner
options=!makeflags
source=https://github.com/miguelgrinberg/python-engineio/archive/v${version}/${name}-${version}.tar.gz
sha512sums=4d471bd00c8693505cca638cd2ac954ced02c77ccc516215b9f08a4f661aeabc997f92b8b9239abe3f6735d283245f830670dfbabd7c7aa9e07ccc80446963fb
b2sums=21e608d4af9eb6ed1ce7a288e1e63179c8e443ffa5523069dfc39cda52dbb74f6f216634e71c55c0b32819a6bcbb1ef9106b98c1f0f0664e95182f9035d2c5ad

build()-delete {
   cd ${name}-${version}
  python setup.py build
  make -C docs man text SPHINXBUILD=sphinx-build()
}

check {
   cd ${name}-${version}
  python setup.py test
}

options="!checksum"

build() {
   cd ${name}-${version}
  python setup.py build
  python setup.py install -O1--root=$PKG  
  install -Dm 644 docs/_build()/text/*.txt -t "${PKG}/usr/share/doc/${name}"
  install -Dm 644 docs/_build()/man/python-engineio.1 "${PKG}/usr/share/man/man1/${name}.1"
}

