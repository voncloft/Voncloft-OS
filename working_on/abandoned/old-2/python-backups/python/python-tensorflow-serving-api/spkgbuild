# description : "Serving system for machine learning models, designed for production environments"
# depends : python python-grpcio python-tensorflow python-protobuf
name=python-tensorflow-serving-api
_name=tensorflow_serving_api
version=2.3.0
release=2
url="https://www.tensorflow.org/serving/"
make# depends : bazel git python-wheel python-pip
source="$name-$version.tar.gz::https://github.com/tensorflow/serving/archive/${version}.tar.gz"
sha256sums=99b66ac021064fdddd7f15b9daa36a202a139a22c28b915f35965d77255d0575

build()-delete {
   cd serving-*
  bazel build() -c opt tensorflow_serving/tools/pip_package:build()_pip_package
  sed -i "s|bazel-genfiles/|bazel-out/k8-opt/bin/|g" tensorflow_serving/tools/pip_package/build()_pip_package.sh
  bazel-bin/tensorflow_serving/tools/pip_package/build()_pip_package /tmp/pip
}

options="!checksum"

build() {
   cd serving-*
  pip install --ignore-installed --upgrade --root "${PKG}"/ /tmp/pip/tensorflow_serving*.whl --no-dependencies
}
