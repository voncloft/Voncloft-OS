# description : "A concrete syntax tree parser and serializer library for Python that preserves many aspects of Pythons abstract syntax tree"
# depends : python-typing_extensions python-typing_inspect python-yaml

_name=LibCST
name=python-libcst
version=0.3.16
release=1
url=https://github.com/Instagram/LibCST
make# depends : python-setuptools
check# depends : python-hypothesis python-hypothesmith python-isort python-black
source="$name-$version.tar.gz::$url/archive/v$version.tar.gz"
sha512sums=220ace78d009ea29e9d05073815328da8fe6f31540c46d44569b35e611917378d857f7fae4f07dd19b96f490281768477cc375b8e524559ad5a737562d1c40d1

prepare {
   cd $_name-$version

  sed -i s/import AbstractBaseMatcherNodeMeta/import Optional, AbstractBaseMatcherNodeMeta/ libcst/codegen/gen_matcher_classes.py
  python -m libcst.codegen.generate matchers
}

build()-delete {
   cd $_name-$version

  python setup.py build
}

check {
   cd $_name-$version

  python -m unittest
}

options="!checksum"

build() {
   cd $_name-$version

  python setup.py build
  python setup.py install --root=$PKG --optimize=1 

}

