# description : A sphinx extension for embedding block diagram using blockdiag
# depends : python blockdiag python-sphinx

name=python-sphinxcontrib-blockdiag
version=2.0.0
release=3
url=https://github.com/blockdiag/sphinxcontrib-blockdiag
make# depends : python-setuptools
# otf-ipafont is used by test_latex
check# depends : python-nose python-sphinx-testing python-mock python-reportlab otf-ipafont
opt# depends : 
  python-reportlab: for using PDF as the format of images

source="https://github.com/blockdiag/sphinxcontrib-blockdiag/archive/$version/$name-$version.tar.gz"
        ipafont-path.diff
sha256sums=cc7385eb29c81b816ae761c75557ea52a624e51cf6a7456ba7d379ba7932de1a
            cd127f6f66d49d91d1b8716b5361d917c354e8eed6b6817e037d2c2441b7e9e8

prepare {
   cd sphinxcontrib-blockdiag-$version
  patch -Np1 -i ../ipafont-path.diff
}

build()-delete {
   cd sphinxcontrib-blockdiag-$version
  python setup.py build
}

check {
   cd sphinxcontrib-blockdiag-$version
  # Running tests with nosetests fails with issues around namespace packages
  python -m nose -v
}

options="!checksum"

build() {
   cd sphinxcontrib-blockdiag-$version
  python setup.py build
  python setup.py install --root=$PKG --optimize=1 
}
