# description : "Socket Mock Framework - for all kinds of socket animals, web-clients included - with gevent/asyncio/SSL support"
# depends : python-decorator python-http-parser python-magic python-urllib3

name=python-mocket
version=3.9.40
release=1
url="https://github.com/mindflayer/python-mocket"
make# depends : python-pipenv-to-requirements python-pytest-cov python-setuptools
check# depends : pifpaf python-aiohttp python-gevent python-mock python-pook python-redis
              python-sure python-xxhash redis
source="https://github.com/mindflayer/python-mocket/archive/$version/$name-$version.tar.gz"
sha512sums=d3f1b9c60d10cc8f803da3e465cd84bc954b885cf8cb400f85eabe8da0f144542f9992849ea86c44bc29d13e6ed3da7f61e472eac2ce81b1d9d2753539653d40

prepare {
   cd python-mocket-$version
  pipenv_to_requirements

  sed -i s/python-magic/file_magic/ requirements.txt
}

build()-delete {
   cd python-mocket-$version
  python setup.py build
}

check {
   cd python-mocket-$version
  pifpaf run redis pytest
}

options="!checksum"

build() {
   cd python-mocket-$version
  python setup.py build
  python setup.py install --root=$PKG --optimize=1

}
