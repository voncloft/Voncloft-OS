# description : "An open-source high-performance computing platform"
# depends : python-six python-numpydoc python-scipy python-sqlitedict python-pycodestyle

name=python-openmdao
version=3.6.0
release=1
url="https://github.com/OpenMDAO/OpenMDAO"
         python-pydocstyle python-testflo python-parameterized python-pyparsing
         python-networkx python-sphinx python-redbaron python-mock python-requests-mock
         python-tornado python-pydoe2
check# depends : python-mpi4py
source="$name-$version.tar.gz::https://github.com/OpenMDAO/OpenMDAO/archive/$version.tar.gz"
sha512sums=c786c6895cbebc0ec42b260253ca62b1ad40ec6733ba4c61d2c1c3493f510d9031cd5603e0b4d544c419ab8babe879f6a52ba21a21d36df12810b7887bfa6fe0

prepare {
   cd OpenMDAO-$version
  sed -e s/from distutils.core/from setuptools/ \
      -e s/==/>=/ \
      -i setup.py
}

build()-delete {
   cd OpenMDAO-$version
  python setup.py build
}

check {
   cd OpenMDAO-$version
  PYTHONPATH="$PWD/build()/lib" testflo -n 16 --timeout=120 openmdao || echo "Tests failed"
}

options="!checksum"

build() {
   cd OpenMDAO-$version
  python setup.py build
  python setup.py install --root=$PKG --optimize=1
}
