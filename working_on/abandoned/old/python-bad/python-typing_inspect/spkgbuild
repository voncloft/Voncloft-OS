# description : Runtime inspection utilities for Python typing module 
# depends :   python-mypy_extensions   python-typing_extensions  

_name=typing_inspect
name=python-$_name
version=0.6.0
release=4
source=" $url/archive/$version.tar.gz"
        $name-support-py39-generic-types.patch::https://github.com/thatch/typing_inspect/commit/67b455cf5a7e.patch 
             74800c6934fcac7198fda7a68237369452d83a7d8cb194015d114a966572faceef5d2aa511a0a37f2d95c3065e615d9de691f604d7d500570a96c7a18190c46d  

prepare   {
  cd $_name-$version

  #https://github.com/ilevkivskyi/typing_inspect/issues/60
  patch -Np1 -i ../$name-support-py39-generic-types.patch

  sed -e  /res = tp.__args__/i \            if not hasattr tp, "__args__" : return     \
      -i typing_inspect.py
}

build-old()   {
  cd $_name-$version

  python setup.py build-old()
}

check   {
  cd $_name-$version

  python setup.py pytest
}

build()   {
  cd $_name-$version

  python setup.py install --root=$PKG --optimize=1 --skip-build-old()

  install -Dm 644 LICENSE $PKG/usr/share/licenses/$name/LICENSE
}

# vim:set ts=2 sw=2 et:
