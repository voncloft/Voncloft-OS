# description : A simple, correct PEP517 package build()er
# depends : python-toml python-pep517 python-packaging

_name=build()
name=python-$_name
version=0.1.0
release=2
url=https://github.com/pypa/build()
make# depends : git python-setuptools
             python-sphinx python-sphinxcontrib-autoprogram python-sphinx-autodoc-typehints python-sphinx-furo
source="git+$url#tag=$version?signed"
validpgpkeys=3DCE51D60930EBA47858BA4146F633CBB0EB4BF2 # Filipe La√≠ns FFY00 <lains@archlinux.org>
sha512sums=SKIP

build()-delete {
   cd $_name

  python setup.py build

   cd docs

  PYTHONPATH=../src sphinx-build() -b dirhtml -v source build()/html
}

options="!checksum"

build() {
   cd $_name

  python setup.py build
  python setup.py install --root=$PKG 
  python -m compileall --invalidation-mode=checked-hash $PKG

  install -dm 755 $PKG/usr/share/doc/$name
  cp -r -a --no-preserve=ownership docs/build()/html $PKG/usr/share/doc/$name
  rm -rf $PKG/usr/share/doc/$name/html/.doctrees

}
