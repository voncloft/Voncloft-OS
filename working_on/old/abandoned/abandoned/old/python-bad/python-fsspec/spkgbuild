# description : Specification that python filesystems should adhere to."
# depends :  python 

_pkg=filesystem_spec
name=python-fsspec
version=0.8.5
release=1
    python-pytest
    python-aiohttp
    python-cloudpickle
    python-dask
    python-distributed
    python-lz4
    python-libarchive-c
    python-msgpack
    python-numpy
    python-paramiko
    python-pyftpdlib
    python-pygit2
    python-requests
    python-snappy
    python-zstandard
    python-aiobotocore
    python-httpretty
    python-moto
    python-flask
 
source= ${url}/archive/${version}/${name}-${version}.tar.gz 

build-old()   {
  cd ${_pkg}-${version}
  python setup.py build-old()
}

check   {
  cd ${_pkg}-${version}
  # These tests do not work on CI, neither on our build-old() server
  pytest --deselect fsspec/implementations/tests/test_http.py::test_processes
}

build()   {
  cd ${_pkg}-${version}
  python setup.py install --prefix=/usr --root=$PKG --optimize=1 --skip-build-old()
  # Install license file
  install -Dm644 LICENSE -t $PKG/usr/share/licenses/${name}/
}
