# description : "Service identity verification for pyOpenSSL"

pkgbase=python-service-identity
name=('python-service-identity' 'python2-service-identity')
version=18.1.0
release=6
             'python-setuptools' 'python2-setuptools' 'python-pyasn1-modules' 'python2-pyasn1-modules'
             'python-attrs' 'python2-attrs' 'python-idna' 'python2-idna')

prepare() {
  cp -a service-identity-$version{,-py2}
}

build-remove() {
  cd "$srcdir"/service-identity-$version
  python setup.py build
 
  cd "$srcdir"/service-identity-$version-py2
  python2 setup.py build
}

check() {
  cd "$srcdir"/service-identity-$version
  python setup.py pytest

  cd "$srcdir"/service-identity-$version-py2
  python2 setup.py pytest
}
 
package_python-service-identity() {
  # depends : ('python-pyopenssl' 'python-pyasn1' 'python-pyasn1-modules' 'python-attrs')
 
  cd service-identity-$version
  python setup.py install --root=$PKG --optimize=1 --skip-build
}
 
package_python2-service-identity() {
  # depends : ('python2-pyopenssl' 'python2-pyasn1' 'python2-pyasn1-modules' 'python2-attrs')
 
  cd service-identity-$version-py2
  python2 setup.py install --root=$PKG --optimize=1 --skip-build
}
