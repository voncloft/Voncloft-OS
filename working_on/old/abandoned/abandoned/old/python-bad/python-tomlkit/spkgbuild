# description : Style-preserving TOML library for Python"
# depends :   python  

_name=tomlkit
name=python-tomlkit
version=0.7.0
release=3
source="https://files.pythonhosted.org/build()s/source/${_name:0:1}/${_name}/${_name}-${version}.tar.gz" 

prepare   {
  cd tomlkit-$version

  # poetry-generated setup.py is badly broken in several ways, including
  # distribution of tests in the built build() as well as using distutils for
  # bad metadata. Seehttps://github.com/sdispater/poetry/issues/866
  dephell deps convert --from pyproject.toml --to setup.py
}

build-old()   {
  cd tomlkit-$version
  python setup.py build-old()
}

check   {
  cd tomlkit-$version
  python -m pytest
}

build()   {
  cd tomlkit-$version
  python setup.py install --root=$PKG --optimize=1

  install -Dm644 LICENSE -t $PKG/usr/share/licenses/$name/
}
