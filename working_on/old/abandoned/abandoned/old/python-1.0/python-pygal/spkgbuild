# Maintainer: Felix Yan <felixonmars@archlinux.org>
# Contributor: Chris Warrick <aur@chriswarrick.com>

name=python-pygal
epoch=1
version=2.4.0
release=8
pkgdesc='A Python SVG graph plotting library'
url='https://www.pygal.org/en/stable/'
depends=('python-setuptools')
optdepends=('python-lxml: for XML output through lxml instead of xml.etree'
            'python-cairosvg: for PNG output')
checkdepends=('python-pytest' 'python-lxml' 'python-pyquery' 'python-cairosvg' 'python-flask')
source=("$name-$version.tar.gz::https://github.com/Kozea/pygal/archive/$version.tar.gz"
        $name-pytest-fix.patch::https://github.com/Kozea/pygal/commit/19e5399be18a.patch)
md5sums=('5c688d30f8e75dced194bfa612f45589'
         '5ca054e5420b1c242d8706f4258ca382')

prepare() {
  sed -i 's/\[pytest\]/[tool:pytest]/' pygal-$version/setup.cfg
  patch -Np1 -d pygal-$version <$name-pytest-fix.patch
}

build() {
  cd pygal-$version
  python setup.py build
}

check() {
  cd pygal-$version
  pytest pygal/
}

package() {
  cd pygal-$version
  python3 setup.py install --root="$pkgdir" --optimize=1
}

# vim:set ts=2 sw=2 et:
