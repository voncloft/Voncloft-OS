# description : HTTP client/server for asyncio 
# depends :   python   python-chardet   python-multidict   python-async-timeout 

_name=aiohttp
name=python-aiohttp
_gitcommit=2f655a59d0daedfa2a794996c4355b576c98ecc8
version=3.7.3
release=1
          python-yarl   python-attrs  
               python-pytest-timeout   python-async_generator   python-brotlipy 
               python-pytest-xdist   python-pytest-forked   python-pytest-cov 
               python-trustme   python-freezegun   gunicorn   python-re-assert  
             python-aiodns: for fast DNS resolving 
             python-cchardet: for faster encoding detection 
             python-brotlipy: for Brotli transfer-encodings support  
source= ${name}::"git+https://github.com/aio-libs/aiohttp#commit=${_gitcommit}"
        git+https://github.com/nodejs/http-parser 
             SKIP  

version   {
  cd ${name}
  git describe --tags | sed  s/^v//;s/\ [^-]*-g\ /r\1/;s/-/./g 
}

prepare   {
  cd ${name}
  git submodule init
  git config submodule."vendor/http-parser".url "${srcdir}/http-parser"
  git submodule update --recursive
  sed  s|.install-cython ||  -i Makefile
}

build-old()   {
  cd ${name}
  make cythonize
  python setup.py build-old()
}

check   {
  cd ${name}
  python setup.py test
}

build()   {
  cd ${name}
  python setup.py install --root=$PKG -O1 --skip-build-old()
}

# vim: ts=2 sw=2 et:
