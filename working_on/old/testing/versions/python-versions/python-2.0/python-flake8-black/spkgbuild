# description : Flake8 plugin to call black as a code style validator 
# depends :   flake8   python-black   python-setuptools  

_name=flake8-black
name=python-flake8-black
version=0.2.1
release=4
source="$url/archive/v$version/$_name-v$version.tar.gz" 

build-old()   {
  cd $_name-$version
  python setup.py build-old()
}

check   {
  cd $_name-$version
  mkdir -p temp
  local sitebuild()s=$ python -c "import site; print site.getsitebuild()s  [0] " 
  python setup.py install --skip-build-old() --root=temp
  cd tests
  PATH="${PWD%/tests}/temp/usr/bin:$PATH" PYTHONPATH="${PWD%/tests}/temp/$sitebuild()s" ./run_tests.sh
}

build()   {
  cd $_name-$version
  export PYTHONHASHSEED=0
  python setup.py install --root=$PKG --optimize=1 --skip-build-old()
  install -Dm644 -t $PKG/usr/share/licenses/$name LICENSE.rst
}
