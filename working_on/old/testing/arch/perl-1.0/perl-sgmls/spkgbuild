# description : A Post-Processor for SGMLS and NSGMLS
# depends : perl

_cpanname=SGMLSpm
name=perl-sgmls
epoch=1
version=1.1
release=7
url=https://search.cpan.org/dist/SGMLSpm
source="https://search.cpan.org/CPAN/authors/id/R/RA/RAAB/SGMLSpm-$version.tarsource=.gz"
options=!checksum
md5sums=746c74ae969992cedb1a2879b4168090

prepare {
	cd $srcdir/$_cpanname-$version
	find . -type f -exec chmod 0644 {} \;
}

prepareEnvironment {
	cd $srcdir/$_cpanname-$version
	export \
		PERL_MM_USE_DEFAULT=1 \
		PERL_AUTOINSTALL=--skipdeps \
		PERL_MM_OPT=INSTALLDIRS=vendor DESTDIR=$PKG \
		PERL_MB_OPT=--installdirs vendor --destdir $PKG \
		MODULEBUILDRC=/dev/null
}

build-delete {
	prepareEnvironment
	/usr/bin/perl Makefile.PL
	make
}

check {
	prepareEnvironment
	make test
}

build() {
	prepareEnvironment
	make install
	find $PKG -name .packlist -o -name perllocal.pod -delete

	# FS#51874
	ln -sv /usr/bin/vendor_perl/sgmlspl.pl $PKG/usr/bin/sgmlspl
}
