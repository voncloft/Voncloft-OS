From f496695228c2fec4942597c74abde746076eac09 Mon Sep 17 00:00:00 2001
From: Eli Schwartz <eschwartz@archlinux.org>
Date: Wed, 27 Feb 2019 01:45:09 -0500
Subject: [PATCH] WIP: Port to Qt5

---
 src/gui/CMainWindow.cpp                       | 78 +++++++++----------
 src/gui/CTree.cpp                             | 35 +++++----
 src/gui/CTreeElement.cpp                      |  2 +-
 .../CConfigurationDialog.cpp                  |  4 +-
 .../dateInputDialog/CDateInputDialog.cpp      |  2 +-
 .../ExpiredElementsDialog.cpp                 |  2 +-
 .../ExpiredElementsDialogInterface.h          | 26 +++----
 .../CIconSelectorDialog.cpp                   |  8 +-
 .../iconselectordialog/CIconSelectorItem.cpp  |  7 +-
 .../dialogs/passwdDialog/CPasswdDialog.cpp    |  2 +-
 .../propertyDialog/CPropertyDialog.cpp        | 14 ++--
 .../dialogs/searchDialog/CSearchListItem.cpp  |  2 +-
 .../searchDialog/CSearchListItemDelegate.cpp  |  2 +-
 src/gui/editor/CEditor.cpp                    | 12 +--
 src/information/CInformationElement.cpp       |  4 +-
 src/information/htmlwriter.cpp                | 16 ++--
 src/information/xmlpersister.cpp              |  2 +-
 src/informationExt/CCollectionModel.cpp       | 52 ++++++-------
 src/persister.cpp                             |  4 +-
 src/utilities/base64/CBase64Coder.cpp         |  2 +-
 tuxcards.pro                                  |  3 +
 21 files changed, 142 insertions(+), 137 deletions(-)
 mode change 100755 => 100644 tuxcards.pro

diff --git a/src/gui/CMainWindow.cpp b/src/gui/CMainWindow.cpp
index d4b4163..9f61ecd 100755
--- a/src/gui/CMainWindow.cpp
+++ b/src/gui/CMainWindow.cpp
@@ -116,7 +116,7 @@ CMainWindow::CMainWindow( const QString& sArg )
 // , mpQuickLoader( NULLPTR )
  , mpStatusBar_ChangeLabel( NULLPTR )
  , mpStatusBar_TextFormatLabel( NULLPTR )
- , mbChangesExist( FALSE )
+ , mbChangesExist( false )
  , mSaveChangesDialog( this )
 
  , mpEditFontCombo( NULLPTR )
@@ -260,7 +260,7 @@ void CMainWindow::settingUpMainWindow()
    settingUpTree( *mpSplit );
    settingUpEditor( *mpSplit );
 
-   mpSplit->setOpaqueResize(TRUE);
+   mpSplit->setOpaqueResize(true);
 
    settingUpActions();
    settingUpMenu();
@@ -535,21 +535,21 @@ void CMainWindow::settingUpActions( void )
 
    // editor actions - text formating
    mpEditBoldAction = new QAction( getIcon("text_bold"), tr("&Bold") /*"(Ctrl+B)"*/, this );
-   QFont f = mpEditBoldAction->font(); f.setBold( TRUE ); mpEditBoldAction->setFont( f );
+   QFont f = mpEditBoldAction->font(); f.setBold( true ); mpEditBoldAction->setFont( f );
    mpEditBoldAction->setShortcut( Qt::ControlModifier + Qt::Key_B );
-   mpEditBoldAction->setCheckable( TRUE );
+   mpEditBoldAction->setCheckable( true );
    connect( mpEditBoldAction, SIGNAL(triggered()), mpEditor, SLOT(toggleFontBold()) );
 
    mpEditItalicAction = new QAction( getIcon("text_italic"), tr("&Italic") /*"(Ctrl+I)"*/, this );
-   f = mpEditItalicAction->font(); f.setItalic( TRUE ); mpEditItalicAction->setFont( f );
+   f = mpEditItalicAction->font(); f.setItalic( true ); mpEditItalicAction->setFont( f );
    mpEditItalicAction->setShortcut( Qt::ControlModifier + Qt::Key_I );
-   mpEditItalicAction->setCheckable( TRUE );
+   mpEditItalicAction->setCheckable( true );
    connect( mpEditItalicAction, SIGNAL(triggered(bool)), mpEditor, SLOT(setFontItalic(bool)) );
 
    mpEditUnderAction = new QAction( getIcon("text_under"), tr("Underline") /*"(Ctrl+U)"*/, this );
-   f = mpEditUnderAction->font(); f.setUnderline( TRUE ); mpEditUnderAction->setFont( f );
+   f = mpEditUnderAction->font(); f.setUnderline( true ); mpEditUnderAction->setFont( f );
    mpEditUnderAction->setShortcut( Qt::ControlModifier + Qt::Key_U );
-   mpEditUnderAction->setCheckable( TRUE );
+   mpEditUnderAction->setCheckable( true );
    connect( mpEditUnderAction, SIGNAL(triggered(bool)), mpEditor, SLOT(setFontUnderline(bool)) );
 
    // color action
@@ -561,35 +561,35 @@ void CMainWindow::settingUpActions( void )
 
    // alignment actions
    mpEditTextLeftAction = new QAction( getIcon("text_left"), tr("Align Left"), this );
-   mpEditTextLeftAction->setCheckable( TRUE );
+   mpEditTextLeftAction->setCheckable( true );
    connect( mpEditTextLeftAction, SIGNAL(triggered()), this, SLOT(textLeft()) );
 
    mpEditTextCenterAction = new QAction( getIcon("text_center"), tr("Center"), this );
-   mpEditTextCenterAction->setCheckable( TRUE );
+   mpEditTextCenterAction->setCheckable( true );
    connect( mpEditTextCenterAction, SIGNAL(triggered()), this, SLOT(textHCenter()) );
 
    mpEditTextRightAction = new QAction( getIcon("text_right"), tr("Align Right"), this );
-   mpEditTextRightAction->setCheckable( TRUE );
+   mpEditTextRightAction->setCheckable( true );
    connect( mpEditTextRightAction, SIGNAL(triggered()), this, SLOT(textRight()) );
 
    mpEditTextBlockAction = new QAction( getIcon("text_block"), tr("Text Block"), this );
-   mpEditTextBlockAction->setCheckable( TRUE );
+   mpEditTextBlockAction->setCheckable( true );
    connect( mpEditTextBlockAction, SIGNAL(triggered()), this, SLOT(textBlock()) );
 
 
    // toggle toolbar actions
    mpMainToolBarAction = new QAction( tr("Show Main Toolbar"), this );
-   mpMainToolBarAction->setCheckable( TRUE );
+   mpMainToolBarAction->setCheckable( true );
    mpMainToolBarAction->setChecked( mConfiguration.getBoolValue( CTuxCardsConfiguration::B_SHOW_MAIN_TOOLBAR ) );
    connect( mpMainToolBarAction, SIGNAL(toggled(bool)), this, SLOT(slotSetMainToolBarVisible(bool)) );
 
    mpEntryToolBarAction = new QAction( tr("Show Entry Manipulation Toolbar"), this );
-   mpEntryToolBarAction->setCheckable( TRUE );
+   mpEntryToolBarAction->setCheckable( true );
    mpEntryToolBarAction->setChecked( mConfiguration.getBoolValue( CTuxCardsConfiguration::B_SHOW_ENTRY_TOOLBAR ) );
    connect( mpEntryToolBarAction, SIGNAL(toggled(bool)), this, SLOT(slotSetEntryToolBarVisible(bool)) );
 
    mpEditorToolBarAction = new QAction( tr("Show Editor Toolbar"), this );
-   mpEditorToolBarAction->setCheckable( TRUE );
+   mpEditorToolBarAction->setCheckable( true );
    mpEditorToolBarAction->setChecked( mConfiguration.getBoolValue( CTuxCardsConfiguration::B_SHOW_EDITOR_TOOLBAR ) );
    connect( mpEditorToolBarAction, SIGNAL(toggled(bool)), this, SLOT(slotSetEditorToolBarVisible(bool)) );
 }
@@ -1124,30 +1124,30 @@ void CMainWindow::textColorChanged( const QColor& c )
 void CMainWindow::textAlignmentChanged( Qt::Alignment a )
 // -------------------------------------------------------------------------------
 {
-   mpEditTextLeftAction->setChecked( FALSE );
-   mpEditTextCenterAction->setChecked( FALSE );
-   mpEditTextRightAction->setChecked( FALSE );
-   mpEditTextBlockAction->setChecked( FALSE );
+   mpEditTextLeftAction->setChecked( false );
+   mpEditTextCenterAction->setChecked( false );
+   mpEditTextRightAction->setChecked( false );
+   mpEditTextBlockAction->setChecked( false );
 
    //std::cout<<"CMainWindow::textAlignmentChanged() to "<<a<<std::endl;
 
    switch (a)
    {
    case Qt::AlignHCenter:
-      mpEditTextCenterAction->setChecked( TRUE );
+      mpEditTextCenterAction->setChecked( true );
       //std::cout<<"center"<<std::endl;
       break;
    case Qt::AlignRight:
-      mpEditTextRightAction->setChecked( TRUE );
+      mpEditTextRightAction->setChecked( true );
       //std::cout<<"right"<<std::endl;
       break;
    case Qt::AlignJustify:
-      mpEditTextBlockAction->setChecked( TRUE );
+      mpEditTextBlockAction->setChecked( true );
       //std::cout<<"just"<<std::endl;
       break;
    case Qt::AlignLeft:
    default:
-      mpEditTextLeftAction->setChecked( TRUE );
+      mpEditTextLeftAction->setChecked( true );
       //std::cout<<"left"<<std::endl;
       break;
    }
@@ -1225,7 +1225,7 @@ void CMainWindow::textBlock()
 // {
 //    QString configurationFileName = QDir::homePath() + "/.tuxcards";
 //
-//    ConfigParser parser( configurationFileName, FALSE );
+//    ConfigParser parser( configurationFileName, false );
 //    parser.setGroup("General");
 //    QString version   = parser.readEntry("Version",   "previousVersion");
 //    // TODO: Check whether this version is correct and does work
@@ -1324,7 +1324,7 @@ QMessageBox::Button CMainWindow::askForSaving( const QString& sQuestion )
 void CMainWindow::loadLastSavedDataIfConfigFileIsFound( const QString& sArg )
 // -------------------------------------------------------------------------------
 {
-   bool bResult = FALSE;
+   bool bResult = false;
 
    if ( sArg != "" )
    {
@@ -1421,13 +1421,13 @@ void CMainWindow::open()
 
 
 /**
- * Returns TRUE, if file was opend successfully; otherwise FALSE.
+ * Returns true, if file was opend successfully; otherwise false.
  */
 // -------------------------------------------------------------------------------
 bool CMainWindow::open( const QString& sFileName )
 // -------------------------------------------------------------------------------
 {
-   bool bRetVal = FALSE;
+   bool bRetVal = false;
 
 //  int format = getDataFileFormat(fileName);
 //
@@ -1461,7 +1461,7 @@ bool CMainWindow::open( const QString& sFileName )
  * informationcollection from it & sets latter one to be presented
  * within tuxcards.
  *
- * Returns TRUE, if file was opend successfully; otherwise FALSE.
+ * Returns true, if file was opend successfully; otherwise false.
  */
 // -------------------------------------------------------------------------------
 bool CMainWindow::openXMLDataFile( const QString& sFileName )
@@ -1482,12 +1482,12 @@ bool CMainWindow::openXMLDataFile( const QString& sFileName )
                            tr("ERROR - Could not open") + " '"+ sAbsoluteFileName
                            + "' " + tr("for reading or parse error."),
                            QMessageBox::Ok, QMessageBox::NoButton, QMessageBox::NoButton);
-      return FALSE;
+      return false;
    }
 
    initializingCollection( sAbsoluteFileName );
 
-   return TRUE;
+   return true;
 }
 
 // -------------------------------------------------------------------------------
@@ -1687,7 +1687,7 @@ void CMainWindow::closeEvent( QCloseEvent* pEv )
 // * informationcollection from it & sets latter one to be presented
 // * within tuxcards.
 // *
-// * Returns TRUE, if file was opend successfully; otherwise FALSE.
+// * Returns true, if file was opend successfully; otherwise false.
 // */
 //// -------------------------------------------------------------------------------
 //bool CMainWindow::openOldDataFile(QString fileName)
@@ -1696,7 +1696,7 @@ void CMainWindow::closeEvent( QCloseEvent* pEv )
 //  QFile file(fileName);
 //  if (! file.open(QIODevice::ReadOnly) ) {
 //    showMessage("ERROR could not open '"+fileName+"' for reading.", 5);
-//    return FALSE;
+//    return false;
 //  }
 //
 //  // create absolute file name, in case a relative one is given
@@ -1715,7 +1715,7 @@ void CMainWindow::closeEvent( QCloseEvent* pEv )
 //  mpCollection = Persister::createInformationCollection( s );
 //  initializingCollection( fileName );
 //
-//  return TRUE;
+//  return true;
 //}
 //
 //
@@ -1816,9 +1816,9 @@ void CMainWindow::showMessage( const QString& sMessage, int iSeconds )
 void CMainWindow::recognizeChanges()
 // -------------------------------------------------------------------------------
 {
-   mbChangesExist = TRUE;
+   mbChangesExist = true;
 
-   setWindowModified( TRUE );  // With this the members 'mpStatusBar_ChangeLabel'
+   setWindowModified( true );  // With this the members 'mpStatusBar_ChangeLabel'
                                // and 'mbChangesExist' can be removed.
 
    if ( mpStatusBar_ChangeLabel )
@@ -1833,9 +1833,9 @@ void CMainWindow::recognizeChanges()
 void CMainWindow::clearChanges()
 // -------------------------------------------------------------------------------
 {
-   mbChangesExist = FALSE;
+   mbChangesExist = false;
 
-   setWindowModified( FALSE );
+   setWindowModified( false );
 
    if ( mpStatusBar_ChangeLabel )
       mpStatusBar_ChangeLabel->setText(" ");
@@ -1853,7 +1853,7 @@ void CMainWindow::callingExecutionStatement() const
    if ( mConfiguration.getStringValue( CTuxCardsConfiguration::S_EXECUTE_STATEMENT ).isEmpty() )
       return;
 
-   system( mConfiguration.getStringValue( CTuxCardsConfiguration::S_EXECUTE_STATEMENT ).toAscii() );
+   system( mConfiguration.getStringValue( CTuxCardsConfiguration::S_EXECUTE_STATEMENT ).toLatin1() );
 }
 
 
@@ -1880,7 +1880,7 @@ void CMainWindow::exportHTML()
   bool bSuccess = HTMLWriter::writeCollectionToHTMLFile( *mpCollection, sDirPath );
 
   // done
-  if ( FALSE != bSuccess )
+  if ( false != bSuccess )
   {
      QMessageBox::information( this, tr("HTML-Export"), tr("HTML") + "<em>" + tr("Export") +
                                "</em> <font size=-1>(" + QString(TUX_SHORT_VERSION) + ")</font> " +
diff --git a/src/gui/CTree.cpp b/src/gui/CTree.cpp
index 233219d..8b44067 100644
--- a/src/gui/CTree.cpp
+++ b/src/gui/CTree.cpp
@@ -25,9 +25,12 @@
 #define  getIcon(x)  CIconManager::getInstance().getIcon(x)
 
 #include <QMessageBox>
+#include <QDrag>
 #include <QDragEnterEvent>
 #include "../CTuxCardsConfiguration.h"
 
+#include <QMimeData>
+
 #define CTREE_COLUMN_ZERO  0
 #define CTREE_AUTO_EXPAND_TIME 750
 
@@ -68,7 +71,7 @@ CTree::CTree( QWidget* pParent )
    settingUpContextMenu();
    mHistory.setListener( this );
 
-   setAcceptDrops( TRUE );
+   setAcceptDrops( true );
 
    initModel();
 }
@@ -102,12 +105,12 @@ void CTree::settingUpActions()
    mpHistoryPrevAction = new QAction( getIcon("back"), tr("Back, Previous Entry (Alt+Left)"), this );
    mpHistoryPrevAction->setShortcut( Qt::AltModifier + Qt::Key_Left );
    connect( mpHistoryPrevAction, SIGNAL(triggered()), this, SLOT(slotActivatePreviousHistoryElement()) );
-   mpHistoryPrevAction->setEnabled( FALSE );
+   mpHistoryPrevAction->setEnabled( false );
 
    mpHistoryNextAction = new QAction( getIcon("forward"), tr("Forward, Next Entry (Alt+Right)"), this );
    mpHistoryNextAction->setShortcut( Qt::AltModifier + Qt::Key_Right );
    connect( mpHistoryNextAction, SIGNAL(triggered()), this, SLOT(slotActivateNextHistoryElement()) );
-   mpHistoryNextAction->setEnabled( FALSE );
+   mpHistoryNextAction->setEnabled( false );
 
 
    mpLockAction = new QAction( getIcon("lock"), tr("Encrypt active Entry"), this );
@@ -115,7 +118,7 @@ void CTree::settingUpActions()
 
    mpRemoveLockAction = new QAction( getIcon("unlock"), tr("Remove Encryption from active Entry"), this );
    connect( mpRemoveLockAction, SIGNAL(triggered()), this, SLOT(slotRemoveEncryptionFromActiveEntry()) );
-   mpRemoveLockAction->setEnabled( FALSE );
+   mpRemoveLockAction->setEnabled( false );
 
 }
 
@@ -136,7 +139,7 @@ void CTree::settingUpContextMenu()
    // add a separator
    QAction* pSeparator = new QAction( "", this );
    Q_ASSERT( pSeparator );
-   pSeparator->setSeparator(TRUE);
+   pSeparator->setSeparator(true);
    addAction( pSeparator );
 
    addAction( mpIEMoveUpAction );
@@ -145,7 +148,7 @@ void CTree::settingUpContextMenu()
    // add another separator
    pSeparator = new QAction( "", this );
    Q_ASSERT( pSeparator );
-   pSeparator->setSeparator(TRUE);
+   pSeparator->setSeparator(true);
    addAction( pSeparator );
 
    addAction( mpHistoryPrevAction );
@@ -412,7 +415,7 @@ void CTree::slotTreeItemCollapsed( const QModelIndex& index )
 
       CTreeInformationElement* pTIE = mModel.mapIndexToIE( index );
       if ( pTIE )
-         pTIE->setOpen( FALSE );
+         pTIE->setOpen( false );
    }
 }
 
@@ -427,7 +430,7 @@ void CTree::slotTreeItemExpanded( const QModelIndex& index )
 
       CTreeInformationElement* pTIE = mModel.mapIndexToIE( index );
       if ( pTIE )
-         pTIE->setOpen( TRUE );
+         pTIE->setOpen( true );
    }
 }
 
@@ -456,7 +459,7 @@ void CTree::currentChanged( const QModelIndex& current, const QModelIndex& previ
 void CTree::addElement()
 // -------------------------------------------------------------------------------
 {
-   Q_ASSERT( TRUE == mModel.isValid() );
+   Q_ASSERT( true == mModel.isValid() );
    if ( !mModel.isValid() )
       return;
 
@@ -506,7 +509,7 @@ void CTree::slotPropertyDialogSuccessfullyClosed()
                         mModel.rowCount( currentIndex() ), currentIndex()
                       );
 
-      setExpanded ( currentIndex(), TRUE );
+      setExpanded ( currentIndex(), true );
    }
 }
 
@@ -537,7 +540,7 @@ void CTree::changeActiveElementProperties()
 void CTree::askForElementDeletionAndDeleteIt()
 // -------------------------------------------------------------------------------
 {
-   Q_ASSERT( TRUE == mModel.isValid() );
+   Q_ASSERT( true == mModel.isValid() );
    if ( !mModel.isValid() )
       return;
 
@@ -580,7 +583,7 @@ void CTree::askForElementDeletionAndDeleteIt()
 void CTree::slotEncryptActiveElement()
 // -------------------------------------------------------------------------------
 {
-   Q_ASSERT( TRUE == mModel.isValid() );
+   Q_ASSERT( true == mModel.isValid() );
    if ( !mModel.isValid() )
       return;
 
@@ -631,7 +634,7 @@ void CTree::slotEncryptActiveElement()
 void CTree::slotRemoveEncryptionFromActiveEntry()
 // -------------------------------------------------------------------------------
 {
-   Q_ASSERT( TRUE == mModel.isValid() );
+   Q_ASSERT( true == mModel.isValid() );
    if ( !mModel.isValid() )
       return;
 
@@ -965,7 +968,7 @@ bool CTree::isEntryDroppedOnItself( const QModelIndex& dropIndex,
    //         <<"against '"<<mpModel->data(mDraggedIndexOrChild).toString().toStdString()<<"'"<<std::endl;
 
    if ( dropIndex ==  draggedIndexOrChild )
-      return TRUE;
+      return true;
 
    QModelIndex parentIndex = draggedIndexOrChild;
 
@@ -974,9 +977,9 @@ bool CTree::isEntryDroppedOnItself( const QModelIndex& dropIndex,
    {
       x = mModel.index( iRow, 0, parentIndex );
       if ( isEntryDroppedOnItself( dropIndex, x ) )
-         return TRUE;
+         return true;
    }
 
-   return FALSE;
+   return false;
 }
 /** *********************** Drag & Drop - end ***********************************/
diff --git a/src/gui/CTreeElement.cpp b/src/gui/CTreeElement.cpp
index 1bbbef1..9121842 100644
--- a/src/gui/CTreeElement.cpp
+++ b/src/gui/CTreeElement.cpp
@@ -69,7 +69,7 @@ void CTreeElement::init( CTreeInformationElement& element )
   connect( &element, SIGNAL(childAdded(CInformationElement*)), this, SLOT(childAddEvent(CInformationElement*)) );
   connect( &element, SIGNAL(childMoved(int, int)), this, SLOT(childMovedEvent(int, int)) );
 
-//  setRenameEnabled(0, TRUE);
+//  setRenameEnabled(0, true);
 }
 
 /**
diff --git a/src/gui/dialogs/configurationDialog/CConfigurationDialog.cpp b/src/gui/dialogs/configurationDialog/CConfigurationDialog.cpp
index 12f7852..a74cbe7 100755
--- a/src/gui/dialogs/configurationDialog/CConfigurationDialog.cpp
+++ b/src/gui/dialogs/configurationDialog/CConfigurationDialog.cpp
@@ -35,9 +35,9 @@ CConfigurationDialog::CConfigurationDialog( QWidget* parent, CTuxCardsConfigurat
    addCactusBarToDialog();
 
    // do not use the lineBreak mode stuff, this is not needed
-   ui.mpLineBreakGroupBox->setVisible( FALSE );
+   ui.mpLineBreakGroupBox->setVisible( false );
 
-   setModal( TRUE );
+   setModal( true );
 
    connect( ui.mpTopColorButton,    SIGNAL(clicked()), this, SLOT(slotChangeTopColor()) );
    connect( ui.mpBottomColorButton, SIGNAL(clicked()), this, SLOT(slotChangeBottomColor()) );
diff --git a/src/gui/dialogs/dateInputDialog/CDateInputDialog.cpp b/src/gui/dialogs/dateInputDialog/CDateInputDialog.cpp
index 5dbd284..23797c7 100644
--- a/src/gui/dialogs/dateInputDialog/CDateInputDialog.cpp
+++ b/src/gui/dialogs/dateInputDialog/CDateInputDialog.cpp
@@ -28,7 +28,7 @@ CDateInputDialog::CDateInputDialog( QWidget* pParent )
 // -------------------------------------------------------------------------------
 {
    ui.setupUi( this );
-   setModal( TRUE );
+   setModal( true );
 }
 
 
diff --git a/src/gui/dialogs/expiredElementsDialog/ExpiredElementsDialog.cpp b/src/gui/dialogs/expiredElementsDialog/ExpiredElementsDialog.cpp
index 2a593e5..3ca11a8 100755
--- a/src/gui/dialogs/expiredElementsDialog/ExpiredElementsDialog.cpp
+++ b/src/gui/dialogs/expiredElementsDialog/ExpiredElementsDialog.cpp
@@ -36,7 +36,7 @@ ExpiredElementsDialog::ExpiredElementsDialog( QWidget* pParent )
    , mContextMenu( pParent )
 // -------------------------------------------------------------------------------
 {
-   setModal( TRUE );
+   setModal( true );
    ui.setupUi(this);
 
    connect( ui.pExpiryList, SIGNAL(clicked(Q3ListViewItem*)), this, SLOT(previewEntry(Q3ListViewItem*)) );
diff --git a/src/gui/dialogs/expiredElementsDialog/ExpiredElementsDialogInterface.h b/src/gui/dialogs/expiredElementsDialog/ExpiredElementsDialogInterface.h
index aecf93b..c13cdbb 100644
--- a/src/gui/dialogs/expiredElementsDialog/ExpiredElementsDialogInterface.h
+++ b/src/gui/dialogs/expiredElementsDialog/ExpiredElementsDialogInterface.h
@@ -2,19 +2,19 @@
 #define EXPIREDELEMENTSDIALOGINTERFACE_H
 
 #include <QtCore/QVariant>
-#include <QtGui/QAction>
-#include <QtGui/QApplication>
-#include <QtGui/QButtonGroup>
-#include <QtGui/QDialog>
-#include <QtGui/QGroupBox>
-#include <QtGui/QHBoxLayout>
-#include <QtGui/QLabel>
-#include <QtGui/QPushButton>
-#include <QtGui/QSpacerItem>
-#include <QtGui/QTextEdit>
-#include <QtGui/QTreeWidget>
-#include <QtGui/QVBoxLayout>
-#include <QtGui/QWidget>
+#include <QAction>
+#include <QApplication>
+#include <QButtonGroup>
+#include <QDialog>
+#include <QGroupBox>
+#include <QHBoxLayout>
+#include <QLabel>
+#include <QPushButton>
+#include <QSpacerItem>
+#include <QTextEdit>
+#include <QTreeWidget>
+#include <QVBoxLayout>
+#include <QWidget>
 #include <Qt3Support/Q3MimeSourceFactory>
 
 class Ui_ExpiredElementsDialogInterface
diff --git a/src/gui/dialogs/iconselectordialog/CIconSelectorDialog.cpp b/src/gui/dialogs/iconselectordialog/CIconSelectorDialog.cpp
index 1580f01..bbd3623 100755
--- a/src/gui/dialogs/iconselectordialog/CIconSelectorDialog.cpp
+++ b/src/gui/dialogs/iconselectordialog/CIconSelectorDialog.cpp
@@ -144,7 +144,7 @@ void CIconSelectorDialog::progressBar_startReadDir( int iDirCount )
 
    ui.pProgressBar->reset();
    ui.pProgressBar->setMaximum( iDirCount );
-   ui.pProgressBar->setVisible( TRUE );
+   ui.pProgressBar->setVisible( true );
 }
 
 // -------------------------------------------------------------------------------
@@ -166,7 +166,7 @@ void CIconSelectorDialog::progressBar_readDirDone()
       return;
 
    ui.pProgressBar->setValue( ui.pProgressBar->maximum() );
-   ui.pProgressBar->setVisible( FALSE );
+   ui.pProgressBar->setVisible( false );
 }
 
 
@@ -183,9 +183,9 @@ void CIconSelectorDialog::readDirectory( const QDir& dir )
       return;
 
    if( dir.isRoot() )
-      ui.pDirectoryUpButton->setEnabled( FALSE );
+      ui.pDirectoryUpButton->setEnabled( false );
    else
-      ui.pDirectoryUpButton->setEnabled( TRUE );
+      ui.pDirectoryUpButton->setEnabled( true );
 
    ui.pList->clear();
    directoryChanged( dir.absolutePath() );
diff --git a/src/gui/dialogs/iconselectordialog/CIconSelectorItem.cpp b/src/gui/dialogs/iconselectordialog/CIconSelectorItem.cpp
index 804487f..71366f0 100644
--- a/src/gui/dialogs/iconselectordialog/CIconSelectorItem.cpp
+++ b/src/gui/dialogs/iconselectordialog/CIconSelectorItem.cpp
@@ -21,7 +21,6 @@
 #include <QFileInfo>
 #include <QPainter>
 #include <QDir>
-#include <QMimeSource>
 #include <QApplication>
 
 static QPixmap *static_pIconFolderLocked = 0;
@@ -57,7 +56,7 @@ CIconSelectorItem::CIconSelectorItem( QListWidget* pParent, QFileInfo* pFI )
    {
       // set font to italic
       QFont f( font() );
-      f.setItalic( TRUE );
+      f.setItalic( true );
       setFont( f );
    }
 
@@ -83,7 +82,7 @@ bool CIconSelectorItem::isDir() const
 // -------------------------------------------------------------------------------
 {
    if ( !mpItemFileInfo )
-      return FALSE;
+      return false;
 
    return mpItemFileInfo->isDir();
 }
@@ -93,7 +92,7 @@ bool CIconSelectorItem::isLink() const
 // -------------------------------------------------------------------------------
 {
    if ( !mpItemFileInfo )
-      return FALSE;
+      return false;
 
    return mpItemFileInfo->isSymLink();
 }
diff --git a/src/gui/dialogs/passwdDialog/CPasswdDialog.cpp b/src/gui/dialogs/passwdDialog/CPasswdDialog.cpp
index 460e044..5df7f73 100644
--- a/src/gui/dialogs/passwdDialog/CPasswdDialog.cpp
+++ b/src/gui/dialogs/passwdDialog/CPasswdDialog.cpp
@@ -31,7 +31,7 @@ CPasswdDialog::CPasswdDialog( QWidget* pParent )
 // -------------------------------------------------------------------------------
 {
    ui.setupUi( this );
-   setModal( TRUE );
+   setModal( true );
 
    connect( ui.mpOkButton, SIGNAL(released()), this, SLOT(slotVerifyPasswd()) );
 }
diff --git a/src/gui/dialogs/propertyDialog/CPropertyDialog.cpp b/src/gui/dialogs/propertyDialog/CPropertyDialog.cpp
index dedb768..85af88c 100644
--- a/src/gui/dialogs/propertyDialog/CPropertyDialog.cpp
+++ b/src/gui/dialogs/propertyDialog/CPropertyDialog.cpp
@@ -54,7 +54,7 @@ CPropertyDialog::CPropertyDialog( QWidget* pParent/*,
 // -------------------------------------------------------------------------------
 {
    ui.setupUi( this );
-   setModal( TRUE );
+   setModal( true );
 
    connect( ui.mpChangeIconButton, SIGNAL(clicked()), this, SLOT(chooseIcon()) );
    connect( ui.mpChangeExpiryDateButton, SIGNAL(clicked()), this, SLOT(openDateInputDialog()) );
@@ -133,7 +133,7 @@ void CPropertyDialog::setUp( CInformationElement* pElement, int iMode )
                      pElement->getDescriptionColor()/*,
                      pElement->isEncryptionEnabled(),
                      pElement->isCurrentlyEncrypted()*/ );
-      ui.mpTextFormatChoser->setEnabled( FALSE );
+      ui.mpTextFormatChoser->setEnabled( false );
    }
    else if ( MODE_CREATE_NEW_ELEMENT == iMode )
    {
@@ -141,7 +141,7 @@ void CPropertyDialog::setUp( CInformationElement* pElement, int iMode )
 
       ui.mpParentLabel->setText( tr("Child from") + " '" + pElement->getDescription() + "'" );
       setAttributes( "", CInformationElement_NO_ICON );
-      ui.mpTextFormatChoser->setEnabled( TRUE );
+      ui.mpTextFormatChoser->setEnabled( true );
    }
    else
    {
@@ -169,13 +169,13 @@ void CPropertyDialog::setAttributes( QString sDescription, QString sIconFilename
    if ( sIconFilename == CInformationElement_NO_ICON )
    {
       // entry without icon
-      ui.mpUseIconGroupBox->setChecked( FALSE );
+      ui.mpUseIconGroupBox->setChecked( false );
       ui.mpIconLabel->setPixmap( mBlankIcon );
    }
    else
    {
       // entry with icon
-      ui.mpUseIconGroupBox->setChecked( TRUE );
+      ui.mpUseIconGroupBox->setChecked( true );
       ui.mpIconLabel->setPixmap( QPixmap::fromImage( QImage(sIconFilename) ) );
    }
    ui.mpLocationLabel->setText( sIconFilename );
@@ -415,12 +415,12 @@ void CPropertyDialog::changeProperties()
    if ( miMode == MODE_CHANGE_PROPERTIES )
    {
       // change properties: name & icon
-      mpEditingElement->setBatched( TRUE );
+      mpEditingElement->setBatched( true );
       mpEditingElement->setDescription( getName() );
       mpEditingElement->setIconFileName( getIconFileName() );
       mpEditingElement->setDescriptionColor( getDescriptionColor() );
       mpEditingElement->setExpiryDate( ui.mpExpiryDateGroupBox->isChecked(), mExpiryDate );
-      mpEditingElement->setBatched( FALSE );
+      mpEditingElement->setBatched( false );
 
       // only do something if encryption mode has changed
 //      if ( bEncryptionModeChanged )
diff --git a/src/gui/dialogs/searchDialog/CSearchListItem.cpp b/src/gui/dialogs/searchDialog/CSearchListItem.cpp
index a7d7589..51679c9 100755
--- a/src/gui/dialogs/searchDialog/CSearchListItem.cpp
+++ b/src/gui/dialogs/searchDialog/CSearchListItem.cpp
@@ -35,7 +35,7 @@ CSearchListItem::CSearchListItem( QTreeWidget* pParent, Path* pPath, int iLocati
    setText( 1, (iLocation == CSearchPosition::SP_NAME ? QString("") : s) );
 
    // Sets the font of column 0 to bold.
-   //QFont f = font(0); f.setBold(TRUE); setFont(0, f);
+   //QFont f = font(0); f.setBold(true); setFont(0, f);
 }
 
 // -------------------------------------------------------------------------------
diff --git a/src/gui/dialogs/searchDialog/CSearchListItemDelegate.cpp b/src/gui/dialogs/searchDialog/CSearchListItemDelegate.cpp
index 0900ff3..1bd15d5 100755
--- a/src/gui/dialogs/searchDialog/CSearchListItemDelegate.cpp
+++ b/src/gui/dialogs/searchDialog/CSearchListItemDelegate.cpp
@@ -62,7 +62,7 @@ void CSearchListItemDelegate::drawDisplay( QPainter* pPainter,
       //QMessageBox::information( 0, "", "<i>CSearchListItemDelegate::drawDisplay()</i>" );
 
       QFont f = pPainter->font();
-      f.setItalic( TRUE );
+      f.setItalic( true );
       pPainter->setFont( f );
       pPainter->setPen( Qt::red );
       pPainter->drawText( option.rect, "abc" );
diff --git a/src/gui/editor/CEditor.cpp b/src/gui/editor/CEditor.cpp
index 8c08f76..e1b1f94 100755
--- a/src/gui/editor/CEditor.cpp
+++ b/src/gui/editor/CEditor.cpp
@@ -32,7 +32,7 @@
 CEditor::CEditor( QWidget *pParent )
   : QTextEdit( pParent )
   , mpActiveElement( NULLPTR )
-  , SEMAPHORE_TEXT_WAS_SET( FALSE )
+  , SEMAPHORE_TEXT_WAS_SET( false )
 //  , meLinebreakMode( LINEBREAK_WITH_CTRL_SHIFT )
   , mbUseRichText( true )
   , mEditorFont()
@@ -82,7 +82,7 @@ QString CEditor::getText( void )
 void CEditor::setText( const QString& sText )
 // -------------------------------------------------------------------------------
 {
-   SEMAPHORE_TEXT_WAS_SET = TRUE;
+   SEMAPHORE_TEXT_WAS_SET = true;
 
    if ( mbUseRichText )
       setHtml( sText );
@@ -158,7 +158,7 @@ void CEditor::initialize( void )
    setText("");
    mpActiveElement = NULLPTR;
 
-   SEMAPHORE_TEXT_WAS_SET = FALSE;
+   SEMAPHORE_TEXT_WAS_SET = false;
 //  connect( this, SIGNAL(textChanged()), this, SLOT(sendUndoAvailableSignal()));
 //  connect( this, SIGNAL(textChanged()), this, SLOT(sendRedoAvailableSignal()));
 }
@@ -197,9 +197,9 @@ void CEditor::sendUndoAvailableSignal( void )
   if ( isUndoAvailable() )
   {
     if ( SEMAPHORE_TEXT_WAS_SET )
-      SEMAPHORE_TEXT_WAS_SET = FALSE;
+      SEMAPHORE_TEXT_WAS_SET = false;
     else
-      emit undoAvailable( TRUE );
+      emit undoAvailable( true );
   }
 }
 */
@@ -425,7 +425,7 @@ return;
    else
    {
       // This should not happen. An informationFormat should always be != NONE.
-      Q_ASSERT( FALSE );
+      Q_ASSERT( false );
    }
 
    setAcceptRichText( mbUseRichText );
diff --git a/src/information/CInformationElement.cpp b/src/information/CInformationElement.cpp
index f71b812..1c200e1 100644
--- a/src/information/CInformationElement.cpp
+++ b/src/information/CInformationElement.cpp
@@ -539,7 +539,7 @@ QString CInformationElement::extractSearchLine( const QTextCursor& c ) const
    for ( i = iStartWithinLine; i >= 0; i-- )
    {
       QChar cChar = sLine.at(i);
-      if ( 0 == cChar.toAscii() )
+      if ( 0 == cChar.toLatin1() )
       {
          iTrimmedLineStart = i+1;
          break;
@@ -550,7 +550,7 @@ QString CInformationElement::extractSearchLine( const QTextCursor& c ) const
    for ( i = iEndWithinLine; i < sLine.length(); i++ )
    {
       QChar cChar = sLine.at(i);
-      if ( 0 == cChar.toAscii() )
+      if ( 0 == cChar.toLatin1() )
       {
          iTrimmedLineEnd = i;
          break;
diff --git a/src/information/htmlwriter.cpp b/src/information/htmlwriter.cpp
index 9be8245..432b022 100755
--- a/src/information/htmlwriter.cpp
+++ b/src/information/htmlwriter.cpp
@@ -38,7 +38,7 @@ QStringList HTMLWriter::static_List = QStringList();
 
 /**
  * Exports a aollection to HTML.
- * Returns 'TRUE' if successful, otherwise 'FALSE'.
+ * Returns 'true' if successful, otherwise 'false'.
  */
 // -------------------------------------------------------------------------------
 bool HTMLWriter::writeCollectionToHTMLFile( CInformationCollection& collection,
@@ -49,15 +49,15 @@ bool HTMLWriter::writeCollectionToHTMLFile( CInformationCollection& collection,
 
    bool bSuccess = createSubDir( dir );
    if ( !bSuccess )
-      return FALSE;
+      return false;
 
    bSuccess = createImages( dir );
    if ( !bSuccess )
-      return FALSE;
+      return false;
 
    static_List.clear();
 
-   // TODO: Check if files could be opened, also. If not -> return 'FALSE'.
+   // TODO: Check if files could be opened, also. If not -> return 'false'.
    createTopFrame( dir );
 
    CInformationElement* pRootElem = collection.getRootElement();
@@ -68,7 +68,7 @@ bool HTMLWriter::writeCollectionToHTMLFile( CInformationCollection& collection,
    }
 
    static_List.clear();
-   return TRUE;
+   return true;
 }
 
 
@@ -77,10 +77,10 @@ bool HTMLWriter::createSubDir( const QDir& dir )
 // -------------------------------------------------------------------------------
 {
    bool bSuccess = dir.mkdir( TUX_HTMLEXPORT_SUBDIR );
-   if ( FALSE == bSuccess )
-      return FALSE;
+   if ( false == bSuccess )
+      return false;
 
-   return TRUE;
+   return true;
 }
 
 // -------------------------------------------------------------------------------
diff --git a/src/information/xmlpersister.cpp b/src/information/xmlpersister.cpp
index 896d6cb..973c52d 100755
--- a/src/information/xmlpersister.cpp
+++ b/src/information/xmlpersister.cpp
@@ -260,7 +260,7 @@ void XMLPersister::parseAttributes( QDomElement& elem,
 bool XMLPersister::createDomDocumentFromFile( QFile& xmlFile, QDomDocument& doc )
 // -------------------------------------------------------------------------------
 {
-   bool bRetVal = FALSE;
+   bool bRetVal = false;
 
    if ( !xmlFile.open( QIODevice::ReadOnly ) )
       return bRetVal;
diff --git a/src/informationExt/CCollectionModel.cpp b/src/informationExt/CCollectionModel.cpp
index d8ac29a..5849abe 100755
--- a/src/informationExt/CCollectionModel.cpp
+++ b/src/informationExt/CCollectionModel.cpp
@@ -75,9 +75,9 @@ bool CCollectionModel::isValid() const
 // -------------------------------------------------------------------------------
 {
    if ( mpCollection )
-      return TRUE;
+      return true;
 
-   return FALSE;
+   return false;
 }
 
 // -------------------------------------------------------------------------------
@@ -196,7 +196,7 @@ bool CCollectionModel::hasChildren ( const QModelIndex& parent /*= QModelIndex()
 {
    //std::cout<<"CCollectionModel::hasChildren( parent is valid = "<<parent.isValid()<<" )";
 
-   bool bRetVal = FALSE;
+   bool bRetVal = false;
 
    if ( !mpCollection )
       return bRetVal;
@@ -207,7 +207,7 @@ bool CCollectionModel::hasChildren ( const QModelIndex& parent /*= QModelIndex()
       Q_ASSERT( NULLPTR != mpCollection->getRootElement() );
 
       if ( mpCollection->getRootElement() )
-         bRetVal = TRUE;
+         bRetVal = true;
    }
    else
    {
@@ -363,18 +363,18 @@ bool CCollectionModel::setData( const QModelIndex& index, const QVariant& value,
 
 
    if (!index.isValid())
-      return FALSE;
+      return false;
 
    if ( Qt::EditRole != iRole )
-      return TRUE;
+      return true;
 
    CInformationElement* pIE = mapIndexToIE( index );
    Q_ASSERT( NULLPTR != pIE );
    if ( !pIE )
-      return TRUE;
+      return true;
 
    pIE->setDescription( value.toString() );
-   return TRUE;
+   return true;
 
    // TODO: dataChanged() signal is not emitted. Is this really necessary?
 }
@@ -541,11 +541,11 @@ bool CCollectionModel::insertRow( const QString&     sDescription,
 {
    Q_ASSERT( NULLPTR != mpCollection );
    if ( !mpCollection )
-      return FALSE;
+      return false;
 
 
    if ( !parent.isValid() )
-      return FALSE;
+      return false;
 
    CInformationElement* pParentIE = mapIndexToIE( parent );
    CTreeInformationElement* pNewElement = createNewChild( sDescription,
@@ -557,7 +557,7 @@ bool CCollectionModel::insertRow( const QString&     sDescription,
                                                           pParentIE );
 
    if ( !pNewElement )
-      return FALSE;
+      return false;
 
 
    beginInsertRows( parent, iRow, iRow );  // begin insertion
@@ -565,7 +565,7 @@ bool CCollectionModel::insertRow( const QString&     sDescription,
    endInsertRows();                        // end insertion
 
    mpCollection->setActiveElement( pNewElement );
-   return TRUE;
+   return true;
 }
 
 /**
@@ -623,22 +623,22 @@ bool CCollectionModel::removeRow( int iRow, const QModelIndex& parent )
 {
    Q_ASSERT( NULLPTR != mpCollection );
    if ( !mpCollection )
-      return FALSE;
+      return false;
 
 
    if ( !parent.isValid() )
-      return FALSE;
+      return false;
 
    CInformationElement* pParentIE = mapIndexToIE( parent );
    Q_ASSERT( NULLPTR != pParentIE );
    if ( !pParentIE )
-      return FALSE;
+      return false;
 
    beginRemoveRows( parent, iRow, iRow );  // begin removal
    pParentIE->removeChild( iRow );
    endRemoveRows();                        // end removal
 
-   return TRUE;
+   return true;
 }
 
 
@@ -769,20 +769,20 @@ bool CCollectionModel::dropMimeData( const QMimeData* pData, Qt::DropAction,
 
    Q_ASSERT( NULLPTR != mpCollection );
    if ( !mpCollection )
-      return FALSE;
+      return false;
 
 
    if ( !pData )
-      return FALSE;
+      return false;
 
 
    if ( !parent.isValid() )
-      return FALSE;
+      return false;
 
    CTreeInformationElement* pParentTIE = dynamic_cast<CTreeInformationElement*>( mapIndexToIE(parent) );
    Q_ASSERT( NULLPTR != pParentTIE );
    if ( !pParentTIE )
-      return FALSE;
+      return false;
 
    //std::cout<<"CCollectionModel::dropMimeData() - possible formats are:"<<std::endl;
    //QStringList possibleDropFormats = pData->formats();
@@ -795,7 +795,7 @@ bool CCollectionModel::dropMimeData( const QMimeData* pData, Qt::DropAction,
       // if data are empty then return
       QString sInformationString = pData->text();
       if ( sInformationString.isEmpty() )
-         return FALSE;
+         return false;
 
       // use first word for entry description
       QString sDescription = sInformationString.section( ' ', 0, 0, QString::SectionSkipEmpty );
@@ -804,12 +804,12 @@ bool CCollectionModel::dropMimeData( const QMimeData* pData, Qt::DropAction,
                                                              InformationFormat::getByString("ASCII"),
                                                              "",
                                                              QColor(0,0,0),
-                                                             FALSE,
+                                                             false,
                                                              QDate::currentDate(),
                                                              pParentTIE );
 
       if ( !pNewElement )
-         return FALSE;
+         return false;
 
       pNewElement->setInformation( sInformationString );
 
@@ -826,14 +826,14 @@ bool CCollectionModel::dropMimeData( const QMimeData* pData, Qt::DropAction,
 
       CInformationCollection* pCollection = XMLPersister::createInformationCollection( sDropData );
       if ( !pCollection )
-         return FALSE;
+         return false;
 
       CInformationElement* pRoot = pCollection->getRootElement();
       CTreeInformationElement* pTIE = dynamic_cast<CTreeInformationElement*>(pRoot);
 
       Q_ASSERT( NULLPTR != pTIE );
       if ( !pTIE )
-         return FALSE;
+         return false;
 
       beginInsertRows( parent, iRow, iRow );  // begin insertion
       pParentTIE->addChild( pTIE );
@@ -842,5 +842,5 @@ bool CCollectionModel::dropMimeData( const QMimeData* pData, Qt::DropAction,
       //std::cout<<"CCollectionModel::dropMimeData() - entry moved"<<std::endl;
    }
 
-   return TRUE;
+   return true;
 }
diff --git a/src/persister.cpp b/src/persister.cpp
index 6ace3d1..2e72246 100755
--- a/src/persister.cpp
+++ b/src/persister.cpp
@@ -93,7 +93,7 @@ void Persister::unpackWithIcons(QString s, bool root, CTreeInformationElement* p
 	knoten=knoten.mid(i+1+l2);
 
 	// check whether this Knoten was opened or closed
-	isOpen = (knoten.left(1)=="+" ? FALSE : TRUE );
+	isOpen = (knoten.left(1)=="+" ? false : true );
 	knoten=knoten.mid(1);
 
 	// extract icon file
@@ -189,7 +189,7 @@ void Persister::unpackWithIcons(QString s, bool root, CTreeInformationElement* p
 //	knoten=knoten.mid(i+1+l2);
 //
 //	// check whether this Knoten was opened or closed
-//	isOpen = (knoten.left(1)=="+" ? FALSE : TRUE );
+//	isOpen = (knoten.left(1)=="+" ? false : true );
 //	knoten=knoten.mid(1);
 //
 //	i=knoten.find("*");
diff --git a/src/utilities/base64/CBase64Coder.cpp b/src/utilities/base64/CBase64Coder.cpp
index 5a2d48d..82610f2 100644
--- a/src/utilities/base64/CBase64Coder.cpp
+++ b/src/utilities/base64/CBase64Coder.cpp
@@ -148,7 +148,7 @@ void CBase64Coder::decode( QByteArray& dest, const QString& sSource ) const
          if ( sSource.length() <= iCurrentSourcePos )
             break;
 
-         unsigned char cSourceChar = sSource[iCurrentSourcePos++].toAscii();
+         unsigned char cSourceChar = sSource[iCurrentSourcePos++].toLatin1();
          if ( ('\n' != cSourceChar) && ('\r' != cSourceChar) )
          {
                if (('=' != cSourceChar) && (sSource.length() > iCurrentSourcePos))
diff --git a/tuxcards.pro b/tuxcards.pro
old mode 100755
new mode 100644
index 60050b4..3650774
--- a/tuxcards.pro
+++ b/tuxcards.pro
@@ -1,5 +1,8 @@
 # TEMPLATE = app #lib
 QT += xml
+QT += gui
+QT += widgets
+QT += printsupport
 
 CONFIG += qt debug  #warn_on release #release  #staticlib
 #exists( $(QTDIR)/lib/libqt-mt* ) {
